const BTN_COMMENCER=document.querySelector(".js_btn-commencez"),ECRAN_COMMENCER=document.querySelector(".js_ecran-commencez"),ECRAN_DEBUG=document.querySelector(".js_debug"),INPUT_SWITCH=(BTN_COMMENCER.addEventListener("click",()=>{ECRAN_COMMENCER.classList.add("hide");var e=DOM_DIFFICULTE_SELECT.value;tirage(e),formulaire(DIFFICULTE[e].crant,DIFFICULTE[e].nbCouleur,CONTENEUR_FORMULAIRE),localStorage.setItem("difficulte",e),document.documentElement.setAttribute("data-diffulte",e),plateau(DIFFICULTE[e].nbEssai,DIFFICULTE[e].crant),ECRAN_COMMENCER.dataset.enCours="false",ECRAN_DECHIFFREUR.dataset.enCours="true",document.querySelector(".js_actuel").scrollIntoView()}),document.getElementById("theme")),PREFERENCE_THEME=localStorage.getItem("mode");function switchTheme(e){e.target.checked?(document.documentElement.setAttribute("data-mode","light"),localStorage.setItem("mode","light")):(document.documentElement.setAttribute("data-mode","dark"),localStorage.setItem("mode","dark"))}PREFERENCE_THEME?(document.documentElement.setAttribute("data-mode",PREFERENCE_THEME),"light"===PREFERENCE_THEME&&(INPUT_SWITCH.checked=!0)):(document.documentElement.setAttribute("data-mode","dark"),localStorage.setItem("mode","dark")),INPUT_SWITCH.addEventListener("change",switchTheme,!1);const DOM_DIFFICULTE_SELECT=document.getElementById("difficulte"),DIFFICULTE={Normal:{crant:4,nbEssai:10,nbCouleur:6},Difficile:{crant:5,nbEssai:12,nbCouleur:8}};for(const c in DIFFICULTE)DOM_DIFFICULTE_SELECT.innerHTML+=`<option value="${c}">${c}</option>`;function dropdown(e){"true"===e.getAttribute("aria-expanded")?(e.setAttribute("aria-expanded","false"),e.parentNode.classList.remove("--ouvert"),e.parentNode.querySelector("ul").classList.add("hide")):(e.setAttribute("aria-expanded","true"),e.parentNode.classList.add("--ouvert"),e.parentNode.querySelector("ul").classList.remove("hide"))}function choixCouleur(e,t,a){let r=e.parentNode.parentNode.parentNode.querySelector(".js_dropdown-label");""!=r.dataset.code&&r.classList.remove(r.dataset.code),r.classList.add("code"+t),r.dataset.code="code"+t,CONTENEUR_FORMULAIRE.children[a].value="code"+t,dropdown(r)}function essaiCombinaison(i){for(var e=INPUT_TIRAGE.value.split(","),t=[],a=document.querySelectorAll(".js_select"),r=0;r<a.length;r++){if(""==a[r].value)return!1;t.push(a[r].value)}let o=0,d=0;for(var n=[],c=[],s=0;s<e.length;s++)e[s]===t[s]?o++:(n.push(e[s]),c.push(t[s]));for(var E=0;E<n.length;E++)if(""!=n[E])for(var l=0;l<c.length;l++)if(n[E]===c[l]){n[E]="",c[l]="",d++;break}majPlateau(i,t,o,d,e)}const MESSAGE=document.querySelector(".js_message-fin"),AFFICHE_SOLUTION=document.querySelector(".js_affiche-solution"),DOM_SOLUTION=document.querySelector(".js_solution"),DOM_RESUME=document.querySelector(".js_resume");function gagne(){MESSAGE.innerHTML="Gagné !",ecranFin(),afficheResume(),effaceSauvegarde()}function perdu(){MESSAGE.innerHTML="Perdu !",ecranFin(),afficheSolution(),afficheResume(),effaceSauvegarde()}function ecranFin(){ECRAN_RECOMMENCEZ.classList.remove("hide"),ECRAN_DECHIFFREUR.classList.add("hide"),ECRAN_DECHIFFREUR.dataset.enCours="false",ZONE_BTN_REGLES.classList.add("hide"),ZONE_SWITCH.classList.add("hide")}function afficheSolution(){SOLUTION={crant:INPUT_TIRAGE.value.split(",")};var e=document.querySelector("#solution").innerHTML;let t=Handlebars.compile(e);DOM_SOLUTION.innerHTML=t(SOLUTION),AFFICHE_SOLUTION.classList.remove("hide")}function afficheResume(){var e=document.querySelector("#resume").innerHTML;let t=Handlebars.compile(e);DOM_RESUME.innerHTML=t(PLATEAU),console.log(PLATEAU)}function effaceSauvegarde(){localStorage.removeItem("tirage"),localStorage.removeItem("plateau"),localStorage.removeItem("difficulte"),localStorage.removeItem("essaiNumero")}const CONTENEUR_FORMULAIRE=document.querySelector(".js_form");function formulaire(e,t,a){let r="";r+='<option value="">Selectionnez</option>';for(let e=1;e<t+1;e++)r+=`<option value="code${e}">Code ${e}</option>`;let o=0,n="";for(;o<e;)n+=`<select id="crant-${o}" class="js_select">${r}</select>`,o++;a.innerHTML=n}let PLATEAU={manche:[]};const DOM_PLATEAU=document.querySelector(".js_plateau");function plateau(t,a){for(let e=0;e<t;e++)PLATEAU.manche[e]={},PLATEAU.manche[e].essaiNumero=e+1,0==e?setPresent(e):(PLATEAU.manche[e].type="Futur",PLATEAU.manche[e].nombreCrant=a);compileHanlebars(),ECRAN_DECHIFFREUR.classList.remove("hide")}function setPresent(a,e){e=e||DOM_DIFFICULTE_SELECT.value;var r=DIFFICULTE[e].crant,o=DIFFICULTE[e].nbCouleur;PLATEAU.manche[a].type="Present",PLATEAU.manche[a].dropdown=[],PLATEAU.manche[a].dropdown.crant=[];for(let t=0;t<r;t++){PLATEAU.manche[a].dropdown.crant[t]=[],PLATEAU.manche[a].dropdown.crant[t].idCouleur=[];for(let e=0;e<o;e++)PLATEAU.manche[a].dropdown.crant[t].idItem=t,PLATEAU.manche[a].dropdown.crant[t].idCouleur[e]=e+1}}function compileHanlebars(){var e=document.querySelector("#manche").innerHTML;let t=Handlebars.compile(e);DOM_PLATEAU.innerHTML=t(PLATEAU)}function majPlateau(t,a,r,o,e){PLATEAU.manche[t-1].type="Passer",delete PLATEAU.manche[t-1].dropdown,PLATEAU.manche[t-1].essai=[];for(const n in a)PLATEAU.manche[t-1].essai[n]=a[n];PLATEAU.manche[t-1].correction=[];a.length;for(let e=0;e<a.length;e++)0!=r?(PLATEAU.manche[t-1].correction[e]=" --n",r--):0!=o?(PLATEAU.manche[t-1].correction[e]=" --b",o--):PLATEAU.manche[t-1].correction[e]="";localStorage.setItem("essaiNumero",t),localStorage.setItem("plateau",JSON.stringify(PLATEAU)),JSON.stringify(a)==JSON.stringify(e)?gagne():DIFFICULTE[DOM_DIFFICULTE_SELECT.value].nbEssai==t?perdu():(setPresent(t),compileHanlebars())}const BTN_RECOMMENCER=document.querySelector(".js_btn-recommencez"),BTN_REGLES=(BTN_RECOMMENCER.addEventListener("click",()=>{ECRAN_DEBUG.classList.add("hide"),ECRAN_COMMENCER.classList.remove("hide"),PLATEAU={manche:[]},DOM_PLATEAU.innerHTML="",ECRAN_DECHIFFREUR.classList.add("hide"),ECRAN_RECOMMENCEZ.classList.add("hide"),ZONE_BTN_REGLES.classList.remove("hide"),ZONE_SWITCH.classList.remove("hide"),SOLUTION.classList.add("hide")}),Handlebars.registerHelper("ifEquals",function(e,t,a){return e==t?a.fn(this):a.inverse(this)}),Handlebars.registerHelper("repeat",function(e,t){for(var a="",r=0;r<e;++r)a+=t.fn(r);return a}),Handlebars.registerHelper("addZero",function(e,t){var a=e.toString().length;let r="";return r=1==a?"0"+e:e}),document.querySelector(".js_regles")),BTN_FERMER_REGLES=document.querySelector(".js_fermer-regles"),ECRAN_REGLES=document.querySelector(".js_ecran-regles"),ZONE_BTN_REGLES=document.querySelector(".js_affiche-regle"),ZONE_SWITCH=document.querySelector(".js_affiche-switch"),ECRAN_DECHIFFREUR=document.querySelector(".js_ecran-dechiffreur"),ECRAN_RECOMMENCEZ=document.querySelector(".js_ecran-recommencez");function masque(e){var t=e.dataset.enCours;let a=e.classList;"true"===t&&a.contains("hide")?a.remove("hide"):a.add("hide")}BTN_REGLES.addEventListener("click",()=>{ECRAN_COMMENCER.classList.add("hide"),ZONE_BTN_REGLES.classList.add("hide"),ECRAN_REGLES.classList.remove("hide"),ECRAN_DECHIFFREUR.classList.add("hide"),ECRAN_RECOMMENCEZ.classList.add("hide")}),BTN_FERMER_REGLES.addEventListener("click",()=>{masque(ECRAN_COMMENCER),masque(ZONE_BTN_REGLES),masque(ECRAN_REGLES),masque(ECRAN_DECHIFFREUR),masque(ECRAN_RECOMMENCEZ)});const BTN_SUPPRIMER_PARTIE=document.querySelector(".js_supprimer-partie"),COULEURS=(BTN_SUPPRIMER_PARTIE.addEventListener("click",()=>{window.confirm("Êtes-vous sûr de vouloir supprimer cette partie ?")&&(effaceSauvegarde(),location.reload())}),["code1","code2","code3","code4","code5","code6","code7","code8"]),INPUT_TIRAGE=document.getElementById("tirage");let tirage=e=>{var t=DIFFICULTE[e].nbCouleur,a=DIFFICULTE[e].crant;let r=0,o=0,n=[],c=[];for(;r<t;)n.push(COULEURS[r]),r++;for(;o<a;){var s=n[Math.floor(Math.random()*n.length)];c.push(s),o++}INPUT_TIRAGE.value=c,localStorage.setItem("tirage",c)},sauvegardeTirage=localStorage.getItem("tirage"),sauvegardePlateau=localStorage.getItem("plateau"),sauvegardeDifficulte=localStorage.getItem("difficulte"),sauvegardeEssaiNumero=localStorage.getItem("essaiNumero");null!==sauvegardeTirage&&null!==sauvegardePlateau&&null!==sauvegardeDifficulte&&null!==sauvegardeEssaiNumero&&(INPUT_TIRAGE.value=sauvegardeTirage,formulaire(DIFFICULTE[sauvegardeDifficulte].crant,DIFFICULTE[sauvegardeDifficulte].nbCouleur,CONTENEUR_FORMULAIRE),document.documentElement.setAttribute("data-diffulte",sauvegardeDifficulte),plateau(DIFFICULTE[sauvegardeDifficulte].nbEssai,DIFFICULTE[sauvegardeDifficulte].crant),ECRAN_COMMENCER.dataset.enCours="false",ECRAN_DECHIFFREUR.dataset.enCours="true",PLATEAU=JSON.parse(sauvegardePlateau),setPresent(Number(sauvegardeEssaiNumero),sauvegardeDifficulte),compileHanlebars(),ECRAN_COMMENCER.classList.add("hide"),document.querySelector(".js_actuel").scrollIntoView());